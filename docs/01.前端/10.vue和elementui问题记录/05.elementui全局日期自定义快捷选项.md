---
title: elementui全局日期自定义快捷选项
date: 2021-12-30 17:03:39
permalink: /pages/92de89/
categories:
  - 前端
  - 项目问题
tags:
  - 
---

Step1：首先在components创建一个公共的目录例如cusdatepicker

```js
<template>
  <div>
    <el-date-picker
      v-model="value"
      :type="dataType"
      :picker-options="pickerOptions"
      range-separator="至"
      start-placeholder="开始日期"
      end-placeholder="结束日期"
      value-format="yyyy-MM-dd HH:mm:ss"
      @change="gettimelist"
      align="right"
    >
    </el-date-picker>
  </div>
</template>
 
<script>
export default {
  props: {
    // 是否添加时分秒 默认不加
    hasMinandSec: {
      type: Boolean,
      default: false,
    },
  },
  data() {
    return {
      value: "",
      dataType:'daterange',
      pickerOptions: {
        shortcuts: [
          {
            text: "今天",
            onClick(picker) {
              const end = new Date();
              const start = new Date();
              start.setHours(0, 0, 0, 0);
              end.setHours(23, 59, 59, 0);
              // start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);
              picker.$emit("pick", [start, end]);
            },
          },
          {
            text: "昨天",
            onClick(picker) {
              const end = new Date();
              const start = new Date();
              start.setTime(start.getTime() - 3600 * 1000 * 24 * 1);
              end.setTime(end.getTime() - 3600 * 1000 * 24 * 1);
              start.setHours(0, 0, 0, 0);
              end.setHours(23, 59, 59, 0);
              picker.$emit("pick", [start, end]);
            },
          },
          {
            text: "本周",
            onClick(picker) {
              const end = new Date();
              const start = new Date();
              start.setTime(
                start.getTime() -
                  3600 * 1000 * 24 * (start.getDay() ? start.getDay() - 1 : 6)
              );
              start.setHours(0, 0, 0, 0);
              end.setHours(23, 59, 59, 0);
 
              picker.$emit("pick", [start, end]);
            },
          },
          {
            text: "上周",
            onClick(picker) {
              // 上周开始时间
              const starta = new Date();
              var first = starta.getDate() - starta.getDay() - 6;
              var startDate = new Date(starta.setDate(first));
              const start = new Date(startDate);
              start.setHours(0, 0, 0, 0);
              //  上周结束时间
              var currentDate = new Date();
              var firsts = currentDate.getDate() - currentDate.getDay() - 6;
              var last = firsts + 6;
              var endDate = new Date(currentDate.setDate(last));
              const end = new Date(endDate);
              end.setHours(23, 59, 59, 0);
              picker.$emit("pick", [start, end]);
            },
          },
          {
            text: "本月",
            onClick(picker) {
              const start = new Date();
              const end = new Date();
              start.setDate(1);
              start.setHours(0, 0, 0, 0);
              end.setHours(23, 59, 59, 0);
 
              picker.$emit("pick", [start, end]);
            },
          },
          {
            text: "上月",
            onClick(picker) {
              const oDate = new Date();
              var year = oDate.getFullYear();
              var month = oDate.getMonth();
              var start, end;
              console.log(month);
              if (month == 0) {
                year--;
                start = new Date(year, 11, 1);
                end = new Date(year, 11, 31);
              } else {
                start = new Date(year, month - 1, 1);
                end = new Date(year, month, 0);
              }
              start.setHours(0, 0, 0, 0);
              end.setHours(23, 59, 59, 0);
              picker.$emit("pick", [start, end]);
            },
          },
        ],
      },
    };
  },
  mounted(){
    this.dataType=this.hasMinandSec==true?'datetimerange':'daterange'
  },
  methods: {
    gettimelist(e) {
      if (e == null) return;
      var date = [];
      if (e[0].indexOf("00:00:00") != -1 && e[1].indexOf("00:00:00") != -1) {
        date[0] = e[0];
        date[1] = e[1].replace("00:00:00", "23:59:59");
        this.value=date
        this.$emit("dateBychild", date);
      } else {
        this.$emit("dateBychild", e);
      }
 
    },
  },
};
</script>
 
<style>
</style>

```
Step2：然后就是在index.js中注册该组件

```js
import datepicker from './index.vue'
const cusdatepicker = {
    install: function(Vue) {
        // 注册并获取组件，然后在main.js中引用，在Vue.use()就可以了
        Vue.component('cusdatepicker', datepicker)
    }
}
export default cusdatepicker

```
Step3：在main.js中引入并使用该组件

```js

// 引入全局日期组件 注意这里引入的是index.js文件
import cusdatepicker from '@/components/cusdatepicker/index'
Vue.use(cusdatepicker);

```

第二种方法  全局注册组件形式稍有不同(较为推荐，不用多建js文件)


```js

// 导入index.vue文件
import cusdatepicker from '@/components/cusdatepicker/index'
Vue.component('cusdatepicker',cusdatepicker)

```